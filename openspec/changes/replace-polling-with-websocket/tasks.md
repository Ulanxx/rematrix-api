## 1. 后端 WebSocket 基础设施
- [ ] 1.1 添加 @nestjs/websockets 依赖到 package.json
- [ ] 1.2 创建 WorkflowWebSocketGateway 类
- [ ] 1.3 实现基于 jobId 的房间管理逻辑
- [ ] 1.4 添加连接认证和验证机制
- [ ] 1.5 实现心跳检测和连接超时处理

## 2. 工作流状态推送集成
- [ ] 2.1 在 WorkflowEngineService 中添加事件发射
- [ ] 2.2 集成 Temporal 工作流状态变更事件
- [ ] 2.3 在 JobsService 中添加状态推送逻辑
- [ ] 2.4 实现工作流阶段完成的实时通知
- [ ] 2.5 添加错误状态和异常情况的推送

## 3. 前端 WebSocket 客户端
- [ ] 3.1 创建 WebSocket 连接管理 Hook
- [ ] 3.2 替换 JobProcess.tsx 中的轮询逻辑
- [ ] 3.3 实现连接断开后的自动重连机制
- [ ] 3.4 添加连接状态指示器
- [ ] 3.5 处理 WebSocket 错误和降级方案

## 4. 测试和验证
- [ ] 4.1 编写 WebSocket 网关单元测试
- [ ] 4.2 编写工作流状态推送集成测试
- [ ] 4.3 测试多客户端同时监听同一任务
- [ ] 4.4 测试网络断开重连场景
- [ ] 4.5 性能测试：对比轮询和 WebSocket 的资源使用

## 5. 文档和部署
- [ ] 5.1 更新 API 文档，添加 WebSocket 接口说明
- [ ] 5.2 编写前端 WebSocket 使用指南
- [ ] 5.3 更新部署配置，确保 WebSocket 代理支持
- [ ] 5.4 添加监控和日志记录
- [ ] 5.5 验证生产环境兼容性
